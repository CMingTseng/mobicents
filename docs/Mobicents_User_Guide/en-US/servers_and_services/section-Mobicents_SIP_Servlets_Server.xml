<?xml version='1.0'?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>
<section
	id="section-Mobicents_SIP_Servlets_Server">
	<title>Mobicents SIP Servlets Server</title>
	<para>Mobicents SIP (Session Initiation Protocol) Servlets deliver a consistent, open platform on which to develop and deploy portable and distributed SIP and Converged Java Enterprise Edition (JEE) services. The Mobicents SIP Servlets Server is a <emphasis>certified</emphasis> implementation of the SIP Servlet v1.1 (JSR 289) specification on top of Tomcat and Jboss containers, and it strives to develop interoperability standards between SIP Servlets and the Java Service Logic Execution Environment (JSLEE) so that applications can exploit the strengths of both. The JAIN-SIP Reference Implementation is leveraged as the SIP stack, and Mobicents JSLEE is used as the SLEE implementation.</para>
	<itemizedlist
		id="itemlist-Principal_and_new_features_of_SIP_Servlets">
		<title>Features of the Mobicents SIP Servlets Server</title>
		<listitem>
			<para>the first <emphasis>certified</emphasis> SIP Servlet v1.1 (JSR 289) implementation</para>
		</listitem>
		<listitem>
			<para>a current call rate of 100 calls per second over a 24-hour duration: 8,640,000 total calls</para>
		</listitem>
		<listitem>
			<para>failover support</para>
		</listitem>
		<listitem>
			<para>merged SIP and HTTP session management</para>
		</listitem>
		<listitem>
			<para>a browser-based Management Console</para>
		</listitem>
		<listitem>
			<para>a bundled JSLEE/SIP interoperability demonstration application</para>
		</listitem>
		<listitem>
			<para>Mobicents Media Server</para>
		</listitem>
		<listitem>
			<para>extensions such as SUBSCRIBE/NOTIFY, among others</para>
		</listitem>
	</itemizedlist>
	
	<!--Installing the JDK-->
	<para
		id="para-section-Mobicents_SIP_Servlets_Server-section-Installing_the_JDK_Version_5.0"><!-- Placeholder for XREFs --></para>
	<xi:include
		xmlns:xi="http://www.w3.org/2001/XInclude"
		href="../modules/section-Installing_the_JDK_Version_5.0.xml" />
	
	<!-- SIP Servlet-Enabled JBoss Application Server -->
	<section
		id="section-binary-SIP_Servlets_Server_with_JBoss-Installing_Configuring_and_Running">
		<title>SIP Servlet-Enabled JBoss Application Server: Installing, Configuring and Running</title>
		<para>You can run the Mobicents SIP Servlets Server on top of either the JBoss Application Server or the Tomcat Servlet Container. This section details how to install the SIP Servlets Server on top of JBoss AS. If you would rather run the SIP Servlets Server on top of the Tomcat Servlet Container, go to <xref
				linkend="section-binary-SIP_Servlets_Server_with_Tomcat-Installing_Configuring_and_Running"/>.</para>
		<formalpara>
			<title>Differences Between a Standard JBoss Installation and One Customized for Mobicents SIP Servlets</title>
			<para>Provided here is a list of differences between a standard JBoss Application Server installation and the Mobicents-provided SIP Servlets-customized JBoss installation. The differences include:</para>
		</formalpara>
		<itemizedlist>
			<listitem>
				<para>The <filename>server/default/deploy</filename> directory contains both HTTP and SIP Servlet applications (WAR and SAR2 files).</para>
			</listitem>
			<listitem>
				<para>The <filename>server/default/deploy/jboss-web.deployer</filename> unit has been modified to provide extended classes to the standard JBoss container classes, in order to allow SIP applications to be loaded and the SIP stack to be started.</para>
			</listitem>
			<listitem>
				<para>The <filename>server/default/deploy/jboss-web.deployer/context.xml</filename> file has been modified to provide the extended manager to be able to manage SIP sessions and SIP application sessions in addition to HTTP sessions.</para>
			</listitem>
			<listitem>
				<para>The <filename>server/default/deploy/jboss-web.deployer/META-INF/jboss-service.xml</filename> file and the <filename>server/default/deploy/jboss-web.deployer/META-INF/webserver-xmbean.xml</filename> file have been modified so that it is now possible for JBoss containers to correctly deploy SIP servlets and converged applications.</para>
			</listitem>
			<listitem>
				<para>A <filename>dars</filename> directory containing all of the default applications' router properties files for using the various SIP Servlets applications (which come bundled with the release) has been added to the <filename>server/default/conf</filename> directory.</para>
				<para>a <filename>dars</filename> directory containing all the default applications router properties files for using the SIP servlets applications bundled with the release has been added to <filename>server/default/conf</filename>.
				</para>
			</listitem>
			<listitem>
				<para>Additional JAR files have been added to enable SIP Servlet functionality. Here is a more-or-less complete list of the JAR files added to the <filename>server/default/deploy/jboss-web.deployer/</filename> directory:</para>
				<itemizedlist>
					<listitem>
						<para>
							<filename>sip-servlets-impl-0.6.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>sip-servlets-spec-1.1.6.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>sip-servlets-application-router-0.6.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>sip-balancer-1.0-SNAPSHOT.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>jain-sip-api-1.2.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>jain-sip-ri-1.2.83.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>concurrent-1.3.4.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>log4j-1.2.14.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>stun4j-1.0-MOBICENTS.jar</filename>
						</para>
					</listitem>
					<listitem>
						<para>
							<filename>dnsjava-2.0.6.jar</filename>
						</para>
					</listitem>
				</itemizedlist>
			</listitem>
		</itemizedlist>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-PreInstall_Requirements_and_Prerequisites">
			<title>Pre-Install Requirements and Prerequisites</title>
			<para></para>
			<variablelist
				id="variablelist-binary-SIP_Servlets_Server_with_JBoss-Hardware_Requirements">
				<title>Hardware Requirements</title>
				<varlistentry>
					<term>Sufficient Disk Space</term>
					<listitem>
						<para>You must have sufficient disk space in order to install the SIP Servlets-customized JBoss binary release. Once unzipped, version 0.6 of the SIP Servlets-customized JBoss binary release requires <emphasis>at least</emphasis> 120 MB of free disk space. Keep in mind that disk space requirements may change from release to release.</para>
					</listitem>
				</varlistentry>
				<varlistentry>
					<term>Anything Java Itself Will Run On</term>
					<listitem>
						<para>The SIP Servlets-customized JBoss Application Server is 100% Java. It will run on the same hardware that the JBoss Application Server runs on.</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<variablelist
				id="variablelist-binary-SIP_Servlets_Server_with_JBoss-Software_Prerequisites">
				<title>Software Prerequisites</title>
				<varlistentry>
					<term>JDK 5 or Higher</term>
					<listitem>
						<para>A working installation of the Java Development Kit (<acronym>JDK</acronym>) version 5 or higher is currently required in order to run the SIP Servlets-customized JBoss binary distribution. For instructions on how to install the JDK, refer to <xref
								linkend="para-section-Mobicents_SIP_Servlets_Server-section-Installing_the_JDK_Version_5.0"/>.</para>
					</listitem>
				</varlistentry>
			</variablelist>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Downloading">
			<title>Downloading</title>
			<para>You can download the latest version of the SIP Servlets-customized JBoss from <ulink
					url="http://www.mobicents.org/mss-downloads.html"/>. The top row of the table holds the latest version. Note that there are two different releases of the SIP Servlets Server for every version: one of them is a SIP Servlets-customized JBoss Application Server, and the other is a SIP Servlet-customized Tomcat Servlet Container. Click the <literal>Download</literal> link on the right to start the download of the SIP Servlets binary distribution you prefer (JBoss or Tomcat) from Sourceforge.net.</para>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Installing">
			<title>Installing</title>
			<para>Once the requirements and prerequisites have been met and you have downloaded the binary distribution zip file, you are ready to install the SIP Servlets-customized JBoss binary distribution. Follow the instructions below for your platform, whether Linux or Windows.</para>
			<note
				id="note-binary-SIP_Servlets_Server_with_JBoss-Use_Version_Numbers_Relevant_to_Your_Installation">
				<title>Use Version Numbers Relevant to Your Installation!</title>
				<para>For clarity, the command line instructions presented in this chapter use specific version numbers and directory names. Remember to replace them with version numbers and file names relevant to those you are actually working with.</para>
			</note>
			<procedure>
				<title>Installing the SIP Servlets-Customized JBoss Binary Distribution on Linux</title>
				<step>
					<para>First, move to the directory to which you downloaded the binary distribution zip file. For this example, we'll assume you're currently in your home directory, and that you downloaded the zip file to a subdirectory of it, referred to as <filename>downloads</filename>.</para>
					<screen>~]# cd downloads</screen>
				</step>
				<step>
					<para>In <filename>downloads</filename>, create a subdirectory to hold the unzipped SIP Servlets-customized JBoss files. It is good practice to include the version number in this directory name; if you do so, remember to correctly match it with the version of the SIP Servlets-customized JBoss binary distribution you downloaded.</para>
					<screen>downloads]$ mkdir &quot;mss-jboss-0.6&quot;</screen>
				</step>
				<step>
					<para>Move the downloaded zip file into the directory you just created:</para>
					<screen>downloads]$ mv &quot;mss-0.6-jboss-4.2.2.GA-0809301055.zip&quot; &quot;mss-jboss-0.6&quot;</screen>
				</step>
				<step>
					<para>Move into that directory:</para>
					<screen>downloads]$ cd &quot;mss-jboss-0.6&quot;</screen>
				</step>
				<step>
					<para>Finally, use Java's <command>jar <option>-xvf</option>
							</command> command to extract the contents of the zip file into the current directory, thus completing the install:</para>
					<screen>mss-jboss-0.6]$ jar -xvf &quot;mss-0.6-jboss-4.2.2.GA-0809301055.zip&quot;</screen>
					<stepalternatives>
						<step>
							<para>Alternatively, if Linux's <command>unzip</command> utility is present on your system or is installable, you can use it in lieu of Java's <command>jar <option>-xvf</option>
									</command> command:</para>
							<screen>mss-jboss-0.6]$ unzip &quot;mss-0.6-jboss-4.2.2.GA-0809301055.zip&quot;</screen>
							<tip>
								<para>You can also use <command>unzip</command>'s <option>-d</option>
									<filename>
								<replaceable>&lt;unzip_to_location&gt;</replaceable>
							</filename> option to extract the zip file's contents to a location other than the current directory.</para>
							</tip>
						</step>
					</stepalternatives>
				</step>
				<step>
					<para>To free disk space, you may want to delete the zip file once you've extracted its contents:</para>
					<screen>mss-jboss-0.6]$ rm &quot;mss-0.6-jboss-4.2.2.GA-0809301055.zip&quot;</screen>
				</step>
			</procedure>
			<procedure>
				<title>Installing the SIP Servlets-customized JBoss Binary Distribution on Windows</title>
				<step>
					<para>For this example, we'll assume that you downloaded the binary distribution zip file to the <filename>My Downloads</filename> folder. First, using Windows Explorer, create a subfolder in <filename>My Downloads</filename> to extract the zip file's contents into. When you name this folder, it is good practice to include the version number; if you do so, remember to correctly match it with the version of the SIP Servlets-customized JBoss Application Server binary distribution you downloaded. In these instructions, we will refer to this folder as <filename>mss-jboss-0.6</filename>.</para>
				</step>
				<step>
					<para>Double-click the downloaded zip file, selecting as the destination folder the one you just created to hold the zip file's contents.</para>
					<stepalternatives>
						<step>
							<para>Alternatively, it is also possible to use Java's <command>jar <option>-xvf</option>
									</command> command to extract the binary distribution files from the zip archive. To use this method instead, first move the downloaded zip file from <filename>My Downloads</filename> to the folder that you just created to hold the SIP Servlets Server files.</para>
						</step>
						<step>
							<para>Then, open the Windows Command Prompt and navigate to the folder holding the archive using the <command>cd</command> command:</para>
							<tip
								id="tip-binary-SIP_Servlets_Server_with_JBoss-Opening_the_Command_Prompt_from_Windows_Explorer">
								<title>Opening the Command Prompt from Windows Explorer</title>
								<para>If you are using Windows Vista®, you can open the Command Prompt directly from Explorer. Hold down the <keycap>Shift</keycap> key and right-click on either a folder, the desktop, or inside a folder. This will cause an <guimenuitem>Open Command Window Here</guimenuitem> context menu item to appear, which can be used to open the Command Prompt with the current working directory set to either the folder you opened, or opened it from.</para>
							</tip>
							<screen>C:\Users\Me&gt;cd &quot;My Downloads\mss-jboss-0.6&quot;</screen>
						</step>
						<step>
							<para>Finally, use the <command>jar <option>-xvf</option>
									</command> command to extract the archive contents into the current folder.</para>
							<screen>C:\Users\Me\My Downloads\mss-jboss-0.6&gt;jar -xvf &quot;mss-0.6-jboss-4.2.2.GA-0809301055.zip&quot;</screen>
						</step>
					</stepalternatives>
				</step>
				<step>
					<para>At this point, you may want to move the folder holding the SIP Servlets-customized JBoss binary files (in this example, the folder named <filename>mss-jboss-0.6</filename>) to another location. This step is not strictly necessary, but it is probably a good idea to move the installation folder from <filename>My Downloads</filename> to a user-defined location for storing runnable programs. Any location will suffice, however.</para>
				</step>
				<step>
					<para>You may also want to delete the zip file after extracting its contents in order to free disk space:</para>
					<screen>C:\Users\Me\My Downloads\mss-jboss-0.6&gt;delete &quot;mss-0.6-jboss-4.2.2.GA-0809301055.zip&quot;</screen>
				</step>
			</procedure>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Configuring">
			<title>Configuring (and Setting JBOSS_HOME)</title>
			<para>Configuring the SIP Servlets-customized JBoss Application Server consists in setting the <envar>JBOSS_HOME</envar> environment variable, and then, optionally, either running the JBoss Application Server (in which case you should jump to <xref
					linkend="section-binary-SIP_Servlets_Server_with_JBoss-Running"/> while remembering to return to this section later), or further customizing the JBoss container, which is detailed in the immediately-following sections. Those sections detail how the SIP Servlets-customized JBoss Application Server can be further customized by adding SIP Connectors and configuring the application router.</para>
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/fragment-Setting_the_JBOSS_HOME_Environment_Variable.xml" />
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/section-binary-SIP_Servlets_Server-SIP_Connectors.xml" />
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/section-binary-SIP_Servlets_Server-Application_Routing_and_Service_Configuration.xml" />
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/section-binary-SIP_Servlets_Server-SIP_Serlets_Server_Logging.xml" />
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Running">
			<title>Running</title>
			<para>Once installed, you can run the SIP Servlets-customized JBoss Application Server by executing the one of the startup scripts in the <filename>bin</filename> directory (on Linux or Windows), or by double-clicking the <filename>run.bat</filename> executable batch file in that same directory (on Windows only). However, we suggest always starting the JBoss Application Server using the terminal or Command Prompt because you are then able to read&#8212;and act upon&#8212;any startup messages, and possibly debug any problems that may arise. In the Linux terminal or Command Prompt, you will be able to tell that the server started successfully if the last line of output is similar to the following (ending with <quote>Started in 23s:648ms</quote>):</para>
			<programlisting><![CDATA[17:48:01,247 INFO  [Server] JBoss (MX MicroKernel) [4.2.2.GA (build: SVNTag=JBoss_4_2_2_GA date=200710221139)] Started in 20s:861ms]]></programlisting>
			<para>Detailed instructions are given below, arranged by platform.</para>
			<procedure>
				<title>Running the SIP Servlets-customized JBoss Application Server on Linux</title>
				<step>
					<para>Change your working directory to the SIP Servlets-customized JBoss's topmost directory (the one in which you extracted the zip file's contents to):</para>
					<screen>downloads]$ cd &quot;mss-jboss-0.6&quot;</screen>
				</step>
				<step
					performance="optional">
					<para>(Optional) Ensure that the <filename>bin/run.sh</filename> start script is executable:</para>
					<screen>mss-jboss-0.6]$ chmod +x bin/run.sh</screen>
				</step>
				<step>
					<para>Finally, execute the <filename>run.sh</filename> Bourne shell script:</para>
					<screen>mss-jboss-0.6]$ ./bin/run.sh</screen>
					<stepalternatives>
						<step>
							<para>Instead of executing the Bourne shell script to start the server, you may alternatively run the <filename>run.jar</filename> executable Java archive in the <filename>bin</filename> directory:</para>
							<screen>mss-jboss-0.6]$ java -jar bin/run.jar</screen>
						</step>
					</stepalternatives>
				</step>
			</procedure>
			<procedure>
				<title>Running the SIP Servlets-customized JBoss Application Server on Windows</title>
				<step>
					<para>There are several different ways to start the SIP Servlets-customized JBoss Application Server on Windows. All of the following methods accomplish the same task.</para>
					<para>Using Windows Explorer, change your folder to the one in which you unzipped the downloaded zip file, and then to the <filename>bin</filename> subfolder.</para>
				</step>
				<step>
					<para>Although not the preferred way (see below), it is possible to start the SIP Servlets-customized JBoss by double-clicking on the <filename>run.bat</filename> executable batch file.</para>
					<stepalternatives>
						<step>
							<para>As mentioned above, the best way to start the SIP Servlets-customized JBoss is by using the Command Prompt. Doing it this way will allow you to view all of the server startup details, which will enable you to easily determine whether any problems were encountered during the startup process. You can open the Command Prompt directly from the <filename>&lt;topmost_directory&gt;\bin</filename> folder in Windows Explorer (see <xref
									linkend="tip-binary-SIP_Servlets_Server_with_JBoss-Opening_the_Command_Prompt_from_Windows_Explorer"/> for details), or you can open the Command Prompt via the <guilabel>Start</guilabel> menu and navigate to the correct folder:</para>
							<screen>C:\Users\Me\My Downloads&gt; cd &quot;mss-jboss-0.6&quot;</screen>
						</step>
						<step>
							<para>Start the JBoss Application Server by running the executable <filename>run.bat</filename> batch file:</para>
							<screen>C:\Users\Me\My Downloads\mss-jboss-0.6&gt;bin\run.bat</screen>
							<stepalternatives>
								<step>
									<para>It is also possible to start the server by running the <filename>run.jar</filename> executable Java archive:</para>
									<screen>C:\Users\Me\My Downloads\mss-jboss-0.6&gt;java -jar bin\run.jar</screen>
								</step>
							</stepalternatives>
						</step>
					</stepalternatives>
				</step>
			</procedure>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Using">
			<title>Using</title>
			<para>Once the server is running, you can access the Mobicents SIP Servlets Management Console by opening your browser and navigating to <ulink
					url="http://localhost:8080/sip-servlets-management/"/>.</para>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Stopping">
			<title>Stopping</title>
			<para>Just as there are multiple ways to run the SIP Servlets-customized JBoss Application Server, there are multiple ways to stop it. Detailed instructions for stopping the JBoss Application Server are given below, arranged by platform. Note that if you properly stop the server, you will see the following three lines as the last output in the Linux terminal or Command Prompt:</para>
			<programlisting>[Server] Shutdown complete
Shutdown complete
Halting VM</programlisting>
			<procedure>
				<title>Stopping the SIP Servlets-customized JBoss Application Server on Linux by Issuing a Control Code</title>
				<step>
					<para>Assuming that you started the JBoss Application Server as a foreground process in the terminal, the easiest way to stop it is by pressing the <keycombo
							action="simul"><keycap>Ctrl</keycap>
						<keycap>c</keycap>
					</keycombo> key combination in the same terminal in which you started it.
						</para>
				</step>
			</procedure>
			<procedure>
				<title>Stopping the SIP Servlets-customized JBoss Application Server on Linux by Executing <filename>shutdown.sh</filename> or <filename>shutdown.jar</filename>
				</title>
				<step>
					<para>Another way to shut down the JBoss Application Server is by executing the <filename>shutdown.sh</filename> Bourne shell script in the <filename>&lt;topmost_directory&gt;/bin</filename> directory. To do so, first change your working directory to the binary distribution's topmost directory (the one to which you extracted the downloaded zip file's contents):</para>
					<screen>downloads]$ cd &quot;mss-jboss-0.6&quot;</screen>
				</step>
				<step
					performance="optional">
					<para>(Optional) Ensure that the bin/shutdown.sh start script is executable:</para>
					<screen>mss-jboss-0.6]$ chmod +x bin/shutdown.sh</screen>
				</step>
				<step>
					<para>Finally, run the <filename>shutdown.sh</filename> executable Bourne shell script, and remember to add the <option>-S</option> option (which is the short option for <option>--shutdown</option>) as a command line argument:</para>
					<screen>mss-jboss-0.6]$ ./bin/shutdown.sh -S</screen>
					<stepalternatives>
						<step>
							<para>Instead of executing the Bourne shell script to stop the server, you may alternatively run the <filename>shutdown.jar</filename> executable Java archive to do so (and remembering, again, to add the <option>-S</option> command line argument):</para>
							<screen>mss-jboss-0.6]$ java -jar bin/shutdown.jar -S</screen>
						</step>
					</stepalternatives>
				</step>
			</procedure>
			<procedure>
				<title>Stopping the SIP Servlets-customized JBoss Application Server on Windows</title>
				<step>
					<para>Stopping the JBoss Application Server on Windows consists in executing either the <filename>shutdown.bat</filename> or the <filename>shutdown.jar</filename> executable file in the <filename>bin</filename> subfolder of the SIP Servlets-customized JBoss binary distribution. Make sure to add the <option>-S</option> option (which is the short option for <option>--shutdown</option>) as a command line argument.</para>
					<screen>C:\Users\Me\My Downloads\mss-jboss-0.6&gt;bin\shutdown.bat -S</screen>
					<stepalternatives>
						<step>
							<para>Alternatively, you can execute the <filename>shutdown.jar</filename> Java archive by running the <command>java <option>-jar</option>
									</command> command, and remembering to add the <option>-S</option> option as a command line argument:</para>
							<screen>C:\Users\Me\My Downloads\mss-jboss-0.6&gt;java -jar bin\shutdown.jar -S</screen>
						</step>
					</stepalternatives>
				</step>
			</procedure>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Testing">
			<title>Testing</title>
			<para></para>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_JBoss-Uninstalling">
			<title>Uninstalling</title>
			<para>To uninstall the SIP Servlets-customized JBoss Application Server, simply delete the directory you decompressed the binary distribution archive into.</para>
		</section>
	</section>
		
	<!-- SIP Servlet-Enabled Tomcat Servlet Container -->
	<section
		id="section-binary-SIP_Servlets_Server_with_Tomcat-Installing_Configuring_and_Running">
		<title>SIP Servlet-Enabled Tomcat Servlet Container: Installing, Configuring and Running</title>
		<para>You can also run the Mobicents SIP Servlets Server on top of the Apache Tomcat Servlet Container. This section provides information on the requirements and prerequisites for running the SIP Servlet-customized Tomcat Container, as well as instructions on how to download, install, run, stop, configure, test and uninstall it.</para>
		<formalpara>
			<title>Differences Between the Standard Tomcat Installation and One Customized for Mobicents SIP Servlets</title>
			<para>Provided here is a list of differences between a standard Tomcat Servlet Container installation and the Mobicents-provided SIP Servlets-customized Tomcat installation. The differences include:</para>
		</formalpara>
		<itemizedlist>
			<listitem>
				<para>The <filename>server.xml</filename> configuration file has been modified to provide extended classes to the standard Tomcat container classes, in order to allow SIP applications to be loaded and the SIP stack started.</para>
			</listitem>
			<listitem>
				<para>A <filename>dars</filename> directory containing the default applications' router properties files for using the SIP Servlet Click-to-Call application (which comes bundled with the release) has been added to the <filename>conf</filename> directory.</para>
			</listitem>
			<listitem>
				<para>Additional JAR files have been added to enable SIP Servlet functionality. Here is a more-or-less complete list of the JAR files added to the <filename>server/default/lib</filename> directory:</para>
				<itemizedlist>
					<listitem>
						<para>sip-servlets-impl-0.6.jar</para>
					</listitem>
					<listitem>
						<para>sip-servlets-spec-1.1.6.jar</para>
					</listitem>
					<listitem>
						<para>sip-balancer-1.0-SNAPSHOT.jar</para>
					</listitem>
					<listitem>
						<para>jain-sip-api-1.2.jar</para>
					</listitem>
					<listitem>
						<para>jain-sip-ri-1.2.83.jar</para>
					</listitem>
					<listitem>
						<para>concurrent-1.3.4.jar</para>
					</listitem>
					<listitem>
						<para>log4j-1.2.14.jar</para>
					</listitem>
					<listitem>
						<para>stun4j-1.0-MOBICENTS.jar</para>
					</listitem>
					<listitem>
						<para>dnsjava-2.0.6.jar</para>
					</listitem>
				</itemizedlist>
			</listitem>
		</itemizedlist>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-PreInstall_Requirements_and_Prerequisites">
			<title>Pre-Install Requirements and Prerequisites</title>
			<variablelist
				id="variablelist-binary-SIP_Servlets_Server_with_Tomcat-Hardware_Requirements">
				<title>Hardware Requirements</title>
				<varlistentry>
					<term>Sufficient Disk Space</term>
					<listitem>
						<para>You must have sufficient disk space in order to install the SIP Servlets-customized Tomcat binary release. Once unzipped, version 0.5 of the SIP Servlets-customized Tomcat binary release requires <emphasis>at least</emphasis> 20 MB of free disk space. Keep in mind that disk space requirements may change from release to release.</para>
					</listitem>
				</varlistentry>
				<varlistentry>
					<term>Anything Java Itself Will Run On</term>
					<listitem>
						<para>The SIP Servlets-customized Tomcat Application Server is 100% Java. It will run on the same hardware that the Tomcat Servlet Container runs on.</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<variablelist
				id="variablelist-binary-SIP_Servlets_Server_with_Tomcat-Software_Prerequisites">
				<title>Software Prerequisites</title>
				<varlistentry>
					<term>JDK 5 or Higher</term>
					<listitem>
						<para>A working installation of the Java Development Kit (<acronym>JDK</acronym>) version 5 or higher is required in order to run the SIP Servlet-customized Tomcat Servlet Container.</para>
						<para>For instructions on how to install the JDK, refer to <xref
								linkend="para-section-Mobicents_SIP_Servlets_Server-section-Installing_the_JDK_Version_5.0"/>.</para>
					</listitem>
				</varlistentry>
			</variablelist>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-Downloading">
			<title>Downloading</title>
			<para>You can download the latest version of the SIP Servlet-customized Tomcat Servlet Container from <ulink
					url="http://www.mobicents.org/mss-downloads.html"/>. The top row of the table holds the latest version. Note that there are two different releases of the SIP Servlets Server for every version: one of them is a SIP Servlets-customized JBoss Application Server, and the other is a SIP Servlet-customized Tomcat Servlet Container. Click the <literal>Download</literal> link on the right to start the download of the SIP Servlets binary distribution you prefer (JBoss or Tomcat) from Sourceforge.net.</para>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-Installing">
			<title>Installing</title>
			<para>Once the requirements and prerequisites have been met and you have downloaded the binary distribution zip file, you are ready to install the SIP Servlet-customized Tomcat binary distribution. Follow the instructions below for your platform, whether Linux or Windows.</para>
			<note
				id="note-binary-SIP_Servlets_Server_with_Tomcat-Use_Version_Numbers_Relevant_to_Your_Installation">
				<title>Use Version Numbers Relevant to Your Installation!</title>
				<para>For clarity, the command line instructions presented in this chapter use specific version numbers and directory names. Remember to replace them with version numbers and file names relevant to those you are actually working with.</para>
			</note>
			<procedure>
				<title>Installing the SIP Servlet-customized Tomcat Binary Distribution on Linux</title>
				<step>
					<para>First, move to the directory to which you downloaded the binary distribution zip file. For this example, we'll assume you're currently in your home directory, and that you downloaded the zip file to a subdirectory of it, referred to as <filename>downloads</filename>.</para>
					<screen>~]$ cd downloads</screen>
				</step>
				<step>
					<para>In <filename>downloads</filename>, create a subdirectory to hold the unzipped SIP Servlet-customized Tomcat files. It is good practice to include the version number in this directory name; if you do so, remember to correctly match it with the version of the SIP Servlet-customized Tomcat binary distribution you downloaded.</para>
					<screen>downloads]$ mkdir &quot;mss-tomcat-0.6&quot;</screen>
				</step>
				<step>
					<para>Move the downloaded zip file into the directory you just created:</para>
					<screen>downloads]$ mv &quot;mss-0.6-apache-tomcat-6.0.14-0809301055.zip&quot; &quot;mss-tomcat-0.6&quot;</screen>
				</step>
				<step>
					<para>Move into that directory:</para>
					<screen>downloads]$ cd &quot;mss-tomcat-0.6&quot;</screen>
				</step>
				<step>
					<para>Finally, use Java's <command>jar <option>-xvf</option>
							</command> command to extract the contents of the zip file into the current directory, thus completing the install:</para>
					<screen>mss-tomcat-0.6]$ jar -xvf &quot;mss-0.6-apache-tomcat-6.0.14-0809301055.zip&quot;</screen>
					<stepalternatives>
						<step>
							<para>Alternatively, if Linux's <command>unzip</command> utility is present on your system or is installable, you can use it in lieu of Java's <command>jar <option>-xvf</option>
									</command> command:</para>
							<screen>mss-tomcat-0.6]$ unzip &quot;mss-0.6-apache-tomcat-6.0.14-0809301055.zip&quot;</screen>
							<tip>
								<para>You can also use <command>unzip</command>'s <option>-d</option>
									<filename>
								<replaceable>&lt;unzip_to_location&gt;</replaceable>
							</filename> option to extract the zip file's contents to a location other than the current directory.</para>
							</tip>
						</step>
					</stepalternatives>
				</step>
				<step>
					<para>To free disk space, you may want to delete the zip file once you've extracted its contents:</para>
					<screen>mss-tomcat-0.6]$ rm &quot;mss-0.6-apache-tomcat-6.0.14-0809301055.zip&quot;</screen>
				</step>
			</procedure>
			<procedure>
				<title>Installing the SIP Servlet-Customized Tomcat Binary Distribution on Windows</title>
				<step>
					<para>For this example, we'll assume that you downloaded the binary distribution zip file to the <filename>My Downloads</filename> folder. First, using Windows Explorer, create a subfolder in <filename>My Downloads</filename> to extract the zip file's contents into. When you name this folder, it is good practice to include the version number; if you do so, remember to correctly match it with the version of the SIP Servlet-customized Tomcat Servlet Container binary distribution you downloaded. In these instructions, we will refer to this folder as <filename>mss-tomcat-0.6</filename>.</para>
				</step>
				<step>
					<para>Double-click the downloaded zip file, selecting as the destination folder the one you just created to hold the zip file's contents.</para>
					<stepalternatives>
						<step>
							<para>Alternatively, it is also possible to use Java's <command>jar <option>-xvf</option>
									</command> command to extract the binary distribution files from the zip archive. To use this method instead, first move the downloaded zip file from <filename>My Downloads</filename> to the folder that you just created to hold the SIP Servlets Server files.</para>
						</step>
						<step>
							<para>Then, open the Windows Command Prompt and navigate to the folder holding the archive using the <command>cd</command> command.</para>
							<tip
								id="tip-binary-SIP_Servlets_Server_with_Tomcat-Opening_the_Command_Prompt_from_Windows_Explorer">
								<title>Opening the Command Prompt from Windows Explorer</title>
								<para>If you are using Windows Vista®, you can open the Command Prompt directly from Explorer. Hold down the <keycap>Shift</keycap> key and right-click on either a folder, the desktop, or inside a folder. This will cause an <guimenuitem>Open Command Window Here</guimenuitem> context menu item to appear, which can be used to open the Command Prompt with the current working directory set to either the folder you opened, or opened it from.</para>
							</tip>
						</step>
						<step>
							<para>Finally, use the <command>jar <option>-xvf</option>
									</command> command to extract the archive contents into the current folder.</para>
							<screen>C:\Users\Me\My Downloads\mss-tomcat-0.6&gt;jar -xvf &quot;mss-0.6-apache-tomcat-6.0.14-0809301055.zip&quot;</screen>
						</step>
					</stepalternatives>
				</step>
				<step>
					<para>At this point, you may want to move the folder holding the SIP Servlet-customized Tomcat binary files (in this example, the folder named <filename>mss-tomcat-0.6</filename>) to another location. This step is not strictly necessary, but it is probably a good idea to move the installation folder from <filename>My Downloads</filename> to a user-defined location for storing runnable programs. Any location will suffice, however.</para>
				</step>
				<step>
					<para>You may want to delete the zip file after extracting its contents in order to free disk space:</para>
					<screen>C:\Users\Me\My Downloads\mss-tomcat-0.6&gt;delete &quot;mss-0.6-apache-tomcat-6.0.14-0809301055.zip&quot;</screen>
				</step>
			</procedure>
		</section>
		<section
			id="section-Configuring">
			<title>Configuring (and Setting CATALINA_HOME)</title>
			<para>Configuring the SIP Servlets-customized Tomcat Container consists in setting the <envar>CATALINA_HOME</envar> environment variable, and then, optionally, either running the SIP Servlets-customized Tomcat (in which case you should jump to <xref
					linkend="section-binary-SIP_Servlets_Server_with_JBoss-Running"/>, while remembering to return to this section later), or further customizing the Tomcat container, which is detailed in the immediately-following sections. Those sections detail how the SIP Servlets-customized Tomcat Container can be further customized by adding SIP Connectors and configuring the application router.</para>
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/fragment-Setting_the_CATALINA_HOME_Environment_Variable.xml" />
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/section-binary-SIP_Servlets_Server-SIP_Connectors.xml" />
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/section-binary-SIP_Servlets_Server-Application_Routing_and_Service_Configuration.xml" />
			<xi:include
				xmlns:xi="http://www.w3.org/2001/XInclude"
				href="../modules/section-binary-SIP_Serlets_Server-SIP_Servlets_Server_Logging.xml" />
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-Running">
			<title>Running</title>
			<para>Once installed, you can run the SIP Servlets-customized Tomcat Application Server by executing the one of the startup scripts in the <filename>bin</filename> directory (on Linux or Windows), or by double-clicking the <filename>run.bat</filename> executable batch file in that same directory (on Windows only). However, we suggest always starting Tomcat using the terminal or Command Prompt because you are then able to read&#8212;and act upon&#8212;any startup messages, and possibly debug any problems that may arise. In the Linux terminal or Command Prompt, you will be able to tell that the server started successfully if the last line of output is similar to the following:</para>
			<programlisting><![CDATA[Using CATALINA_BASE:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-0.6
Using CATALINA_HOME:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-0.6
Using CATALINA_TMPDIR: /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-0.6/temp
Using JRE_HOME:       /etc/java-config-2/current-system-vm]]></programlisting>
			<para>Detailed instructions are given below, arranged by platform.</para>
			<procedure>
				<title>Running the SIP Servlets-customized Tomcat Application Server on Linux</title>
				<step>
					<para>Change your working directory to the SIP Servlets-customized Tomcat's topmost directory (the one in which you extracted the zip file's contents to):</para>
					<screen>downloads]$ cd &quot;mss-tomcat-0.6&quot;</screen>
				</step>
				<step
					performance="optional">
					<para>(Optional) Ensure that the <filename>bin/startup.sh</filename> start script is executable:</para>
					<screen>mss-tomcat-0.6]$ chmod +x bin/startup.sh</screen>
				</step>
				<step>
					<para>Finally, execute the <filename>startup.sh</filename> Bourne shell script:</para>
					<screen>mss-tomcat-0.6]$ ./bin/startup.sh</screen>
				</step>
			</procedure>
			<procedure>
				<title>Running the SIP Servlets-customized Tomcat Application Server on Windows</title>
				<step>
					<para>There are several different ways to start the SIP Servlets-customized Tomcat Application Server on Windows. All of the following methods accomplish the same task.</para>
					<para>Using Windows Explorer, change your folder to the one in which you unzipped the downloaded zip file, and then to the <filename>bin</filename> subfolder.</para>
				</step>
				<step>
					<para>Although not the preferred way (see below), it is possible to start the SIP Servlets-customized Tomcat by double-clicking on the <filename>startup.bat</filename> executable batch file.</para>
					<stepalternatives>
						<step>
							<para>As mentioned above, the best way to start the SIP Servlets-customized Tomcat is by using the Command Prompt. Doing it this way will allow you to view all of the server startup details, which will enable you to easily determine whether any problems were encountered during the startup process. You can open the Command Prompt directly from the <filename>&lt;topmost_directory&gt;\bin</filename> folder in Windows Explorer (see <xref
									linkend="tip-binary-SIP_Servlets_Server_with_JBoss-Opening_the_Command_Prompt_from_Windows_Explorer"/> for details), or you can open the Command Prompt via the <guilabel>Start</guilabel> menu and navigate to the correct folder:</para>
							<screen>C:\Users\Me\My Downloads&gt; cd &quot;mss-tomcat-0.6&quot;</screen>
						</step>
						<step>
							<para>Start the JBoss Application Server by running the executable <filename>startup.bat</filename> batch file:</para>
							<screen>C:\Users\Me\My Downloads\mss-tomcat-0.6&gt;bin\startup.bat</screen>
						</step>
					</stepalternatives>
				</step>
			</procedure>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-Stopping">
			<title>Stopping</title>
			<para>Just as there are multiple ways to run the SIP Servlets-customized Tomcat Servlet Container, there are multiple ways to stop it. Detailed instructions for stopping the Tomcat Servlet Container are given below, arranged by platform. Note that if you properly stop the server, you will see the following three lines as the last output in the Linux terminal or Command Prompt (the terminal/Command Prompt output of both running and stopping the SIP Servlet-customized Tomcat Servlet Container is the same):</para>
			<screen><![CDATA[Using CATALINA_BASE:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-0.6
Using CATALINA_HOME:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-0.6
Using CATALINA_TMPDIR: /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-0.6/temp
Using JRE_HOME:       /etc/java-config-2/current-system-vm]]></screen>
			<procedure>
				<title>Stopping the SIP Servlets-customized Tomcat Servlet Container on Linux by Executing <filename>shutdown.sh</filename>
				</title>
				<step>
					<para>Another way to shut down the Tomcat Servlet Container is by executing the <filename>shutdown.sh</filename> Bourne shell script in the <filename>&lt;topmost_directory&gt;/bin</filename> directory. To do so, first change your working directory to the binary distribution's topmost directory (the one to which you extracted the downloaded zip file's contents):</para>
					<screen>downloads]$ cd &quot;mss-tomcat-0.6&quot;</screen>
				</step>
				<step
					performance="optional">
					<para>(Optional) Ensure that the bin/shutdown.sh start script is executable:</para>
					<screen>mss-tomcat-0.6]$ chmod +x bin/shutdown.sh</screen>
				</step>
				<step>
					<para>Finally, run the <filename>shutdown.sh</filename> executable Bourne shell script</para>
					<screen>mss-tomcat-0.6]$ ./bin/shutdown.sh</screen>
				</step>
			</procedure>
			<procedure>
				<title>Stopping the SIP Servlets-customized Tomcat Servlet Container on Windows</title>
				<step>
					<para>Stopping the Tomcat Servlet Container on Windows consists in executing the <filename>shutdown.bat</filename> executable batch script in the <filename>bin</filename> subfolder of the SIP Servlets-customized Tomcat binary distribution:</para>
					<screen>C:\Users\Me\My Downloads\mss-tomcat-0.6&gt;bin\shutdown.bat</screen>
				</step>
			</procedure>
		</section>
		<section
			condition="section-binary-SIP_Servlets_Server-Using">
			<title>Using</title>
			<para>After starting the server successfully, you can access the default web applications included with the SIP Servlet-customized Tomcat Servlet Container by opening the following URL in your browser: <ulink
					url="http://localhost:8080/"/>.</para>
			<para>You can also access the SIP Servlets Management Console by opening <ulink
					url="http://localhost:8080/sip-servlets-management/"/> in your browser.</para>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-Testing">
			<title>Testing</title>
			<para></para>
		</section>
		<section
			id="section-binary-SIP_Servlets_Server_with_Tomcat-Uninstalling">
			<title>Uninstalling</title>
			<para>To uninstall the SIP Servlet-customized Tomcat Servlet Container, simply delete the directory you decompressed the binary distribution archive into.</para>
		</section>
	</section>
</section>

