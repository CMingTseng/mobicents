<?xml version="1.0" encoding="UTF-8"?>
<deployment xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	    xsi:schemaLocation="urn:jboss:bean-deployer:2.0 bean-deployer_2_0.xsd"
	    xmlns="urn:jboss:bean-deployer:2.0">
                
    <bean name="AudioPlayerFactory" class="org.mobicents.media.server.impl.resource.audio.AudioPlayerFactory"/>
    
    <bean name="MuxFactory" class="org.mobicents.media.server.impl.resource.MuxFactory">
        <constructor>
            <parameter>Mux</parameter>
        </constructor>
    </bean>
    
    <bean name="DspFactory" class="org.mobicents.media.server.impl.dsp.DspFactory">
        <property name="name">Dsp</property>
        <property name="codecFactories">
            <list elemntClass="org.mobicents.media.server.spi.dsp.CodecFactory">
                <value>G711.UlawEncoderFactory</value>
                <value>G711.UlawDecoderFactory</value>
            </list>
        </property>
    </bean>
    
    <bean name="DtmfGenFactory" class="org.mobicents.media.server.impl.events.dtmf.DtmfGeneratorFactory">
        <property name="name">DtmfGenerator</property>
    </bean>
    
    <bean name="Pipe-1" class="org.mobicents.media.server.resource.PipeFactory">
        <property name="outlet">Mux</property>
    </bean>
    
    <bean name="Pipe-2" class="org.mobicents.media.server.resource.PipeFactory">
        <property name="inlet">DtmfGenerator</property>
        <property name="outlet">Mux</property>
    </bean>
    
    <bean name="Pipe-3" class="org.mobicents.media.server.resource.PipeFactory">
        <property name="inlet">Mux</property>
        <property name="outlet">Dsp</property>
    </bean>
    
    <bean name="Pipe-4" class="org.mobicents.media.server.resource.PipeFactory">
        <property name="inlet">Dsp</property>
    </bean>
    
    <bean name="TxChannelFactory" class="org.mobicents.media.server.resource.ChannelFactory">
        <property name="components">
            <list>
                <inject bean="MuxFactory"/>
                <inject bean="DspFactory"/>
                <inject bean="DtmfGenFactory"/>
            </list>
        </property>
        <property name="pipes">
            <list>
                <inject bean="Pipe-1"/>
                <inject bean="Pipe-2"/>
                <inject bean="Pipe-3"/>
                <inject bean="Pipe-4"/>
            </list>
        </property>
    </bean>
	<!-- ANNOUNCEMENT  -->
    <bean name="Announcement-Access-Point" class="org.mobicents.media.server.EndpointImpl">
        <property name="localName">
            /mobicents/media/aap/[1..10]
        </property>
        <property name="timer">
            <inject bean="Timer"/>
        </property>
        <property name="sourceFactory">
            <inject bean="AudioPlayerFactory"/>
        </property>
        <property name="rtpFactory">
            <map class="java.util.Hashtable" keyClass="java.lang.String" valueClass="org.mobicents.media.server.resource.ChannelFactory">
                <entry>
                    <key>audio</key><value><inject bean="RTPAudioFactory"/></value>
                </entry>
            </map>
        </property>
        <property name="txChannelFactory">
            <inject bean="TxChannelFactory"/>
        </property>
    </bean>
    
</deployment>