<?xml version="1.0" encoding="utf-8"?>
<project name="HttpServletRAExampleTest" default="test">

	<property name="src" value="./src" />
	<property name="lib" value="./lib" />
	<property name="classes" value="./classes" />
        <property name="test.reports" value="./reports" />
	<property name="test.class.name" value="org.mobicents.sleetests.httpservletra.HttpServletRATest" />

	<import file="${ant.file.HttpServletRAExampleTest}/../../../lib/build.xml"/>
	
	
	<path id="test.classpath">
	  <pathelement location="${classes}" />
	  <fileset dir="${lib}">
	    <include name="**/*.jar"/>
	  </fileset>
		<path refid="examples-libraries"/>
	</path>

	<!-- TASKS TO ENSURE BUILD DIRECTORIES -->
	<target name="ensure-classes-dir">
		<mkdir dir="${test.reports}" />
	</target>

	<target name="ensure-reports-dir">
		<mkdir dir="${classes}" />
	</target>

	<target name="compile-tests" depends="ensure-classes-dir">
		<echo>Compiling Test Classes</echo>
		<javac srcdir="${src}" destdir="${classes}" debug="on">
			<classpath>
				<path refid="test.classpath" />
			</classpath>			
		</javac>
	</target>

	<target name="test" depends="compile-tests">
	  <junit fork="yes" haltonfailure="yes">
	    <test name="${test.class.name}" />
	    <formatter type="plain" usefile="false" />
	    <classpath refid="test.classpath" />
	  </junit>
	</target>


	<target name="test-html" depends="compile-tests,ensure-reports-dir">
	  <junit fork="yes" printsummary="no" haltonfailure="no">
	    <batchtest fork="yes" todir="${test.reports}" >
	      <fileset dir="${classes}">
	        <include name="**/*Test.class" />
	      </fileset>
	    </batchtest>
	    <formatter type="xml" />
	    <classpath refid="test.classpath" />
	  </junit>

	  <junitreport todir="${test.reports}">
	    <fileset dir="${test.reports}">
	      <include name="TEST-*.xml" />
	    </fileset>
	    <report todir="${test.reports}" />
	  </junitreport>
	</target>

	<target name="clean" >
		<delete dir="${classes}" quiet="true" />
		<mkdir dir="${classes}" />

		<delete dir="${test.reports}" quiet="true" />
		<mkdir dir="${test.reports}" />

	</target>

</project>
