<?xml version="1.0" encoding="utf-8"?>
<project name="HttpServletResourceAdaptor" default="build-and-deploy-ra">

	<property name="compile.as.debug" value="true" />

	<import file="$${ant.file.HttpServletResourceAdaptor}/../../../core/xml/ant/mobicents-ant-common-ra.xml" />


	<property name="ra.name" value="httpservlet" />
	<property name="ra.entity" value="HttpServletRA" />
	<property name="ra.id" value="${ant.project.name}#org.mobicents#1.0" />

	<path id="ra.classpath">
		<path refid="mobicents.core.classpath" />
		<path refid="mobicents.ra.${ra.name}ra.classpath" />
	</path>

	<fileset id="ra.libs.ratype" dir="lib">
		<include name="servlet-api.jar" />
	</fileset>

	<property name="servlet.dir" value="servlet" />
	<property name="servlet.war" value="mobicents.war" />
	<property name="servlet.deploy.dir" value="${jboss.home}/server/all/deploy" />

	<target name="clean-servlet">
		<delete dir="${servlet.dir}/war" />
	</target>

	<target name="build-servlet" description="Builds the web application archive">
		<mkdir dir="${servlet.dir}/classes/WEB-INF/classes" />
		<javac debug="true" deprecation="true" destdir="${servlet.dir}/classes/WEB-INF/classes" srcdir="${servlet.dir}/src">
			<classpath refid="ra.classpath" />
		</javac>
		<copy todir="${servlet.dir}/classes">
			<fileset dir="${servlet.dir}/src">
				<exclude name="org/**" />
			</fileset>
		</copy>
		<mkdir dir="${servlet.dir}/war/" />
		<jar destfile="${servlet.dir}/war/${servlet.war}">
			<fileset dir="${servlet.dir}/classes" />
		</jar>
		<delete dir="${servlet.dir}/classes" />
	</target>

	<target name="deploy-servlet" depends="build-servlet">
		<copy todir="${servlet.deploy.dir}" file="${servlet.dir}/war/${servlet.war}" />
	</target>

	<target name="undeploy-servlet">
		<delete file="${servlet.deploy.dir}/${servlet.war}" />
	</target>


	<target name="package-for-release" depends="build-DUs,package-for-release-do-dir,package-for-release-makeprops-with-file,pacakge-for-release-generic-notmain,pacakge-for-release-generic-main,build-servlet">

		<copy file="${servlet.dir}/war/${servlet.war}" todir="${stage.dir}" />


	</target>

</project>

